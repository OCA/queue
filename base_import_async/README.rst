===================
Asynchronous Import
===================

.. !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   !! This file is generated by oca-gen-addon-readme !!
   !! changes will be overwritten.                   !!
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

.. |badge1| image:: https://img.shields.io/badge/maturity-Production%2FStable-green.png
    :target: https://odoo-community.org/page/development-status
    :alt: Production/Stable
.. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
    :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
    :alt: License: AGPL-3
.. |badge3| image:: https://img.shields.io/badge/github-OCA%2Fqueue-lightgray.png?logo=github
    :target: https://github.com/OCA/queue/tree/14.0/base_import_async
    :alt: OCA/queue
.. |badge4| image:: https://img.shields.io/badge/weblate-Translate%20me-F47D42.png
    :target: https://translation.odoo-community.org/projects/queue-14-0/queue-14-0-base_import_async
    :alt: Translate me on Weblate
.. |badge5| image:: https://img.shields.io/badge/runbot-Try%20me-875A7B.png
    :target: https://runbot.odoo-community.org/runbot/230/14.0
    :alt: Try me on Runbot

|badge1| |badge2| |badge3| |badge4| |badge5| 

This module extends the standard CSV import functionality
to import files in the background using the OCA/queue
framework.

**Table of contents**

.. contents::
   :local:

Usage
=====

The user is presented with a new checkbox in the import
screen. When selected, the import is delayed in a background
job.

This job in turn splits the CSV file in chunks of minimum
100 lines (or more to align with record boundaries). Each
chunk is then imported in a separate background job.

When an import fails, the job is marked as such and the
user can read the error in the job status. The CSV chunk
being imported is stored as an attachment to the job, making
it easy to download it, fix it and run a new import, possibly
in synchronous mode since the chunks are small.

Any file that can be imported by the standard import mechanism
can also be imported in the background.

This module's scope is limited to making standard imports
asynchronous. It does not attempt to transform the data nor
automate ETL flows.

Other modules may benefit from this infrastructure in the following way
(as illustrated in the test suite):

1. create an instance of `base_import.import` and populate its fields
   (`res_model`, `file`, `file_name`),
2. invoke the `do` method with appropriate options
   (`header`, `encoding`, `separator`, `quoting`,
   `use_queue`, `chunk_size`).

Known issues / Roadmap
======================

* There is currently no user interface to control the chunk size,
  which is currently 100 by default. Should this proves to be an issue,
  it is easy to add an option to extend the import screen.
* Validation cannot be run in the background.

Changelog
=========

13.0.1.0.0 (2019-12-20)
~~~~~~~~~~~~~~~~~~~~~~~

* [MIGRATION] from 12.0 branched at rev. a7f8031

Bug Tracker
===========

Bugs are tracked on `GitHub Issues <https://github.com/OCA/queue/issues>`_.
In case of trouble, please check there if your issue has already been reported.
If you spotted it first, help us smashing it by providing a detailed and welcomed
`feedback <https://github.com/OCA/queue/issues/new?body=module:%20base_import_async%0Aversion:%2014.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.

Do not contact contributors directly about support or help with technical issues.

Credits
=======

Authors
~~~~~~~

* Akretion
* ACSONE SA/NV

Contributors
~~~~~~~~~~~~

Sébastien Beau (Akretion) authored the initial prototype.

Stéphane Bidoul (ACSONE) extended it to version 1.0 to support
multi-line records, store data to import as attachments
and let the user control the asynchronous behaviour.

Other contributors include:

* Anthony Muschang (ACSONE)
* David Béal (Akretion)
* Jonathan Nemry (ACSONE)
* Laurent Mignon (ACSONE)
* Dennis Sluijk (Onestein)
* Guewen Baconnier (Camptocamp)

Maintainers
~~~~~~~~~~~

This module is maintained by the OCA.

.. image:: https://odoo-community.org/logo.png
   :alt: Odoo Community Association
   :target: https://odoo-community.org

OCA, or the Odoo Community Association, is a nonprofit organization whose
mission is to support the collaborative development of Odoo features and
promote its widespread use.

This module is part of the `OCA/queue <https://github.com/OCA/queue/tree/14.0/base_import_async>`_ project on GitHub.

You are welcome to contribute. To learn how please visit https://odoo-community.org/page/Contribute.
